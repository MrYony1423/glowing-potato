<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CapCut-like Editor ×¢× ××•×–×™×§×” ××•×‘× ×™×ª</title>
<style>
  * { box-sizing: border-box; }
  body {
    margin:0; padding:0; background:#121212; color:#eee;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }
  header {
    background:#1f1f1f; padding:16px; font-size:22px; font-weight:700;
    text-align:center; border-bottom: 2px solid #2c7df7;
  }
  #app {
    display: flex; flex-direction: column; height: 100vh;
  }
  #editor {
    flex:1; display:flex; overflow:hidden;
  }
  #sidebar {
    width: 260px; background:#1c1c1c; padding: 20px; border-right: 1px solid #333;
    display:flex; flex-direction: column;
  }
  #sidebar input[type=file], #sidebar button, #musicSelect {
    margin-bottom: 15px; padding: 12px; border-radius: 8px; border:none;
    background: linear-gradient(90deg,#3a86ff,#0056d6);
    color: white; font-weight: 600; cursor: pointer;
    transition: background 0.3s ease;
    font-size: 16px;
  }
  #sidebar button:hover, #musicSelect:hover {
    background: linear-gradient(90deg,#0056d6,#003d99);
  }
  #main {
    flex:1; display:flex; flex-direction: column; padding:20px;
  }
  #preview {
    flex:1; background:#222; border-radius: 12px;
    display:flex; justify-content: center; align-items: center;
    position: relative;
    overflow: hidden;
  }
  video, canvas {
    max-width: 100%; max-height: 100%; border-radius: 12px;
    background: black;
  }
  #overlayText {
    position: absolute;
    top: 10%; left: 10%;
    color: white;
    font-size: 2rem;
    font-weight: 700;
    text-shadow: 2px 2px 8px #000;
    pointer-events: none;
    user-select: none;
  }
  #timeline {
    height: 140px;
    background: #1e1e1e;
    margin-top: 15px;
    border-radius: 12px;
    border: 2px solid #333;
    padding: 12px;
    overflow-x: auto;
    display: flex;
    align-items: center;
  }
  #timeline > div {
    background: #3a86ff;
    height: 60px;
    width: 120px;
    margin-right: 10px;
    border-radius: 8px;
    display: flex;
    justify-content: center;
    align-items: center;
    color: white;
    font-weight: 700;
    cursor: pointer;
    user-select: none;
  }
  #timeline > div:hover {
    background: #0056d6;
  }
  label {
    font-weight: 700;
    margin-bottom: 5px;
  }
  input[type=text], input[type=color], input[type=range], select {
    margin-bottom: 15px;
    padding: 8px;
    border-radius: 8px;
    border: none;
    font-size: 16px;
  }
</style>
</head>
<body>
<header>ğŸ¬ ×¢×•×¨×š ×•×™×“××• ×¢× ××•×–×™×§×” ××•×‘× ×™×ª</header>
<div id="app">
  <div id="editor">
    <div id="sidebar">
      <label for="videoFile">×‘×—×¨ ×•×™×“××• / ×ª××•× ×”:</label>
      <input type="file" id="videoFile" accept="video/*,image/*" />
      <label for="musicSelect">×‘×—×¨ ××•×–×™×§×” ××•×‘× ×™×ª:</label>
      <select id="musicSelect">
        <option value="">-- ×œ×œ× ××•×–×™×§×” --</option>
        <option value="https://cdn.pixabay.com/download/audio/2022/03/15/audio_45eec7eb7f.mp3?filename=happy-upbeat-6154.mp3">Happy Upbeat</option>
        <option value="https://cdn.pixabay.com/download/audio/2021/12/21/audio_99e8c1ec5f.mp3?filename=calm-and-peaceful-14692.mp3">Calm and Peaceful</option>
        <option value="https://cdn.pixabay.com/download/audio/2022/06/10/audio_c7e4bf713f.mp3?filename=summer-fun-15499.mp3">Summer Fun</option>
      </select>
      <label for="textInput">×˜×§×¡×˜ ×œ×”×•×¡×¤×”:</label>
      <input type="text" id="textInput" placeholder="×›×ª×•×‘ ×›××Ÿ ×˜×§×¡×˜..." />
      <label for="textColor">×¦×‘×¢ ×˜×§×¡×˜:</label>
      <input type="color" id="textColor" value="#ffffff" />
      <label for="textSize">×’×•×“×œ ×˜×§×¡×˜:</label>
      <input type="range" id="textSize" min="12" max="72" value="32" />
      <button id="addTextBtn">â• ×”×•×¡×£ ×˜×§×¡×˜</button>
      <label for="trimStart">×—×™×ª×•×š ×ª×—×™×œ×ª ×•×™×“××• (×‘×©× ×™×•×ª):</label>
      <input type="number" id="trimStart" min="0" value="0" />
      <label for="trimEnd">×—×™×ª×•×š ×¡×•×£ ×•×™×“××• (×‘×©× ×™×•×ª):</label>
      <input type="number" id="trimEnd" min="0" value="0" />
      <button id="applyTrimBtn">âœ‚ï¸ ×”×—×œ ×—×™×ª×•×š</button>
    </div>
    <div id="main">
      <div id="preview">
        <video id="video" controls></video>
        <canvas id="canvas" style="display:none;"></canvas>
        <div id="overlayText"></div>
      </div>
      <div id="timeline">
        <div id="layerVideo" title="×•×™×“××•">×•×™×“××•</div>
        <div id="layerAudio" title="××•×“×™×•">××•×“×™×•</div>
        <div id="layerText" title="×˜×§×¡×˜×™×">×˜×§×¡×˜×™×</div>
      </div>
    </div>
  </div>
</div>
<script>
  const videoFileInput = document.getElementById('videoFile');
  const musicSelect = document.getElementById('musicSelect');
  const video = document.getElementById('video');
  const canvas = document.getElementById('canvas');
  const overlayText = document.getElementById('overlayText');
  const textInput = document.getElementById('textInput');
  const textColorInput = document.getElementById('textColor');
  const textSizeInput = document.getElementById('textSize');
  const addTextBtn = document.getElementById('addTextBtn');
  const trimStartInput = document.getElementById('trimStart');
  const trimEndInput = document.getElementById('trimEnd');
  const applyTrimBtn = document.getElementById('applyTrimBtn');

  let audio = null;
  let currentTexts = [];
  let trimStart = 0;
  let trimEnd = 0;

  videoFileInput.addEventListener('change', e => {
    const file = e.target.files[0];
    if (!file) return;
    const url = URL.createObjectURL(file);
    if(file.type.startsWith('image/')) {
      // Show image on canvas
      const ctx = canvas.getContext('2d');
      const img = new Image();
      img.onload = () => {
        video.style.display = 'none';
        canvas.style.display = 'block';
        canvas.width = img.width;
        canvas.height = img.height;
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.drawImage(img, 0, 0);
        overlayText.style.display = 'none';
      };
      img.src = url;
      video.src = '';
      stopAudio();
    } else {
      // Show video
      canvas.style.display = 'none';
      overlayText.style.display = 'block';
      video.style.display = 'block';
      video.src = url;
      video.load();
      video.currentTime = 0;
      currentTexts = [];
      updateOverlay();
      stopAudio();
    }
  });

  musicSelect.addEventListener('change', () => {
    stopAudio();
    const musicUrl = musicSelect.value;
    if(musicUrl) {
      audio = new Audio(musicUrl);
      audio.loop = true;
      audio.volume = 0.7;
      if(!video.paused) audio.play();
    }
  });

  video.addEventListener('play', () => {
    if(audio) audio.play();
  });
  video.addEventListener('pause', () => {
    if(audio) audio.pause();
  });
  video.addEventListener('seeking', () => {
    if(audio) audio.currentTime = video.currentTime;
  });
  video.addEventListener('timeupdate', () => {
    if(audio && Math.abs(audio.currentTime - video.currentTime) > 0.3) {
      audio.currentTime = video.currentTime;
    }
  });

  addTextBtn.addEventListener('click', () => {
    const text = textInput.value.trim();
    if(!text) return alert('×›×ª×•×‘ ×˜×§×¡×˜ ×œ×”×•×¡×¤×”');
    currentTexts.push({
      text,
      color: textColorInput.value,
      size: parseInt(textSizeInput.value),
      x: 50,
      y: 50 + currentTexts.length * 40,
    });
    updateOverlay();
    textInput.value = '';
  });

  function updateOverlay() {
    if(!video.src) {
      overlayText.style.display = 'none';
      return;
